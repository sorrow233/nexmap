# FUTURE_BETA - 近期功能增强路线图

> 📅 创建日期：2026-01-04
> 
> 🎯 这份文档基于对现有代码库的深度分析，提出在**现有架构基础上**可以快速实现的功能增强，旨在显著提升用户体验。

---

## 目录

1. [智能画布体验增强](#1-智能画布体验增强)
2. [AI 对话能力升级](#2-ai-对话能力升级)
3. [协作与分享功能](#3-协作与分享功能)
4. [数据管理与导出](#4-数据管理与导出)
5. [用户界面优化](#5-用户界面优化)
6. [移动端体验优化](#6-移动端体验优化)

---

## 1. 智能画布体验增强

> 🎨 基于现有 `Canvas.jsx`、`cardSlice.js`、`connectionSlice.js` 的增强

### 1.1 智能卡片对齐系统
- **磁性对齐线**：拖拽卡片时自动显示与其他卡片的对齐参考线
- **智能间距建议**：自动计算最优卡片间距，一键等距排列
- **网格吸附模式**：可选的网格吸附功能，确保布局整齐
- **对齐快捷键**：选中多卡片后，一键左对齐/居中对齐/等间距分布

### 1.2 连线样式增强
- **连线标签**：在连线上添加文字说明，描述卡片间关系（如"导致"、"依赖"、"反对"）
- **连线颜色**：支持不同颜色的连线区分不同类型的关系
- **连线动画**：可选的流动动画，突出信息流向
- **连线粗细**：根据关系强度调整连线粗细

### 1.3 画布导航增强
- **缩略图导航器**：右下角显示整个画布的缩略图，点击快速跳转
- **卡片搜索并定位**：搜索结果直接高亮并飞跃定位到目标卡片
- **区域书签**：保存当前视口位置为书签，一键切换视角
- **画布历史轨迹**：记录浏览路径，支持前进/后退导航

### 1.4 智能布局算法
- **思维导图布局**：从中心卡片向外辐射的经典思维导图样式
- **流程图布局**：从左到右或从上到下的流程图布局
- **聚类布局**：根据连接关系自动聚类相关卡片
- **力导向布局**：物理模拟的动态布局，相关卡片自动靠近

### 1.5 Zone 分组增强
- **Zone 模板**：预设的 Zone 颜色和样式模板（头脑风暴、SWOT分析、时间线等）
- **Zone 折叠**：折叠 Zone 显示为单一图标，节省空间
- **Zone 锁定**：锁定 Zone 内卡片位置，防止误操作
- **Zone 复制**：整体复制 Zone 及其内部所有卡片

### 1.6 便签增强
- **便签颜色**：多种颜色选择，与 Zone 颜色协调
- **便签图标**：添加 emoji 或图标作为便签前缀
- **便签大小**：可调节便签大小，支持小号标注和大号醒目提示
- **便签链接**：便签可链接到外部 URL

---

## 2. AI 对话能力升级

> 🤖 基于现有 `llm.js`、`AIManager.js`、`aiSlice.js` 的增强

### 2.1 对话上下文管理
- **上下文范围选择**：AI 生成时可选择包含连接卡片的内容作为上下文
- **上下文预览**：发送前预览 AI 将看到的完整上下文
- **上下文长度控制**：设置最大上下文长度，避免 token 超限
- **选择性上下文**：手动选择哪些消息/卡片包含在上下文中

### 2.2 Prompt 模板系统
- **预设 Prompt 库**：内置常用 Prompt（总结、翻译、代码解释、头脑风暴等）
- **自定义 Prompt 模板**：用户可创建和保存自己的 Prompt 模板
- **Prompt 变量**：模板支持 `{{selected_text}}`、`{{card_content}}` 等变量
- **Prompt 分享**：导出/导入 Prompt 模板包

### 2.3 多模型策略
- **模型快速切换**：在聊天时快速切换模型，无需进入设置
- **模型对比**：同一问题发给多个模型，并排展示结果
- **自动模型选择**：根据任务类型（代码/创意/分析）自动选择最佳模型
- **模型响应历史**：查看同一问题在不同模型的历史回答

### 2.4 AI 话题扩展增强
- **扩展深度控制**：设置 Sprout 生成的层级深度（1级/2级/3级）
- **扩展方向引导**：指定扩展的方向（优点、缺点、替代方案、相关案例等）
- **批量扩展**：一次性对多个选中话题进行扩展
- **扩展模板**：保存成功的扩展 Prompt 作为模板复用

### 2.5 图片生成增强
- **图片风格预设**：一键选择风格（写实、卡通、irasutoya、水彩等）
- **图片尺寸选择**：支持多种预设尺寸（正方形、横幅、头像等）
- **图片编辑**：简单的裁剪、滤镜功能
- **图片变体**：基于已生成图片生成变体

### 2.6 AI 辅助分析
- **自动主题提取**：分析当前画板内容，自动识别主要主题
- **内容结构化**：将对话内容结构化为大纲、表格、Markdown
- **冲突检测**：检测画板中相互矛盾的观点并高亮
- **洞察生成**：分析所有卡片后生成整体洞察报告

### 2.7 语音交互
- **语音输入**：语音转文字输入问题
- **AI 语音朗读**：将 AI 回复转为语音播放
- **实时翻译**：语音输入时实时翻译为目标语言

### 2.8 实时网络搜索增强
- **搜索结果引用**：在回复中清晰标注引用来源
- **搜索结果卡片化**：将搜索结果独立生成为可参考的卡片
- **网页内容总结**：输入 URL 自动抓取内容并总结
- **最新信息偏好**：优先使用最近的搜索结果

### 2.9 代码能力增强
- **代码高亮**：回复中的代码自动语法高亮
- **一键复制代码块**：代码块旁边显示复制按钮
- **代码运行（沙箱）**：简单代码（JS/Python）可在浏览器沙箱运行
- **代码差异对比**：在多轮代码修改中显示 diff

### 2.10 多模态增强
- **PDF 解析**：上传 PDF 文件，AI 可阅读并回答问题
- **网页截图分析**：截取网页区域，AI 分析内容
- **手写识别**：上传手写图片，AI 识别文字内容
- **图片文字提取 (OCR)**：从图片中复制文字

---

## 3. 协作与分享功能

> 👥 基于现有 `syncService.js`、`shareSlice.js` 的增强

### 3.1 画板分享
- **公开链接分享**：生成可公开访问的只读分享链接
- **密码保护**：为分享链接设置访问密码
- **过期时间**：设置分享链接的有效期限
- **访问统计**：查看分享链接的访问次数和时间

### 3.2 画板嵌入
- **嵌入代码生成**：生成 iframe 嵌入代码，可嵌入博客/文档
- **嵌入样式自定义**：选择深色/浅色主题，是否显示工具栏
- **交互式嵌入**：嵌入的画板可交互（仅查看模式）
- **响应式嵌入**：嵌入画板自动适应容器大小

### 3.3 导出增强
- **高清图片导出**：支持 2x、3x 分辨率导出
- **区域导出**：选择画布区域导出，而非整个画布
- **多格式支持**：PNG、JPEG、SVG、PDF 导出
- **水印选项**：可选添加或移除水印

### 3.4 链接预览
- **卡片链接预览**：分享单张卡片的内容作为社交媒体预览卡
- **OG 图片自动生成**：为分享链接自动生成精美的预览图
- **Twitter/Facebook 优化**：针对不同社交平台优化预览

### 3.5 版本管理
- **画板快照**：保存画板的某个时间点状态
- **快照对比**：对比两个快照之间的差异
- **快照恢复**：一键恢复到历史快照
- **自动快照**：达到关键操作数时自动创建快照

### 3.6 模板系统
- **画板模板**：保存当前画板结构为模板（保留结构，清除内容）
- **社区模板**：浏览和使用其他用户分享的模板
- **模板分类**：按用途分类（项目管理、学习笔记、创意brainstorm等）
- **模板预览**：使用前预览模板结构

### 3.7 团队协作基础
- **只读协作者**：邀请他人查看画板（无编辑权限）
- **评论功能**：在卡片上添加评论，异步讨论
- **@ 提及**：在评论中 @ 其他用户
- **评论通知**：收到评论时的邮件/推送通知

### 3.8 导入功能
- **Markdown 导入**：将 Markdown 文件转换为卡片结构
- **OPML 导入**：从思维导图软件导入大纲
- **JSON 导入**：批量导入结构化数据作为卡片
- **剪贴板智能导入**：粘贴文本自动识别并结构化

### 3.9 Notion/Obsidian 集成
- **Notion 同步**：双向同步指定 Notion 数据库
- **Obsidian 导出**：导出为 Obsidian 兼容的 Markdown 文件夹
- **Roam Research 导出**：支持 Roam 的双向链接格式导出
- **Logseq 兼容**：支持 Logseq 格式导出

### 3.10 API 开放
- **RESTful API**：开放画板 CRUD 的 API 接口
- **Webhook 支持**：画板变更时触发 Webhook
- **Zapier 集成**：通过 Zapier 连接其他应用
- **API 密钥管理**：生成和管理 API 访问密钥

---

## 4. 数据管理与导出

> 💾 基于现有 `boardService.js`、`indexedDB.js`、`storage.js` 的增强

### 4.1 批量操作
- **批量删除**：选中多个画板一键删除
- **批量导出**：选中多个画板打包导出
- **批量标签**：为多个画板批量添加/删除标签
- **批量移动**：将多个画板移动到文件夹

### 4.2 文件夹管理
- **创建文件夹**：支持创建文件夹组织画板
- **嵌套文件夹**：支持多层文件夹结构
- **文件夹颜色**：为文件夹设置辨识色
- **拖拽移动**：拖拽画板到文件夹

### 4.3 画板搜索增强
- **全文搜索**：搜索画板内所有卡片的内容
- **高级筛选**：按创建时间、修改时间、卡片数量筛选
- **搜索历史**：保存常用搜索条件
- **搜索结果排序**：按相关性、时间、卡片数排序

### 4.4 回收站增强
- **批量恢复**：选中多个已删除画板批量恢复
- **永久删除确认**：二次确认永久删除
- **自动清理**：设置回收站自动清理时间
- **恢复历史**：记录恢复操作历史

### 4.5 数据统计
- **使用仪表盘**：可视化展示使用统计
- **卡片统计**：按画板统计卡片数量
- **AI 使用统计**：统计 AI 对话次数和 token 消耗
- **创作趋势**：展示每日/每周创作活跃度

### 4.6 自动备份
- **定时备份**：设置每日/每周自动备份到云端
- **本地备份**：一键下载完整数据备份
- **增量备份**：只备份变更部分，节省空间
- **备份加密**：备份文件加密保护

### 4.7 数据清理
- **未使用附件清理**：检测并清理未引用的图片
- **空画板清理**：一键清理无内容的空画板
- **重复内容检测**：检测高度相似的卡片
- **存储占用分析**：按画板分析存储占用

### 4.8 跨设备同步优化
- **同步状态指示**：清晰显示同步状态（已同步/同步中/待同步/冲突）
- **选择性同步**：选择哪些画板需要云同步
- **离线优先**：优化离线体验，联网后自动合并
- **冲突可视化**：清晰展示同步冲突的具体内容

### 4.9 数据迁移
- **账号合并**：将另一个账号的数据迁移过来
- **导出所有数据**：GDPR 合规的完整数据导出
- **删除所有数据**：永久删除账户和所有关联数据
- **迁移向导**：逐步引导的数据迁移流程

### 4.10 附件管理
- **附件浏览器**：集中管理所有上传的图片和文件
- **附件压缩**：可选压缩大尺寸图片节省空间
- **附件替换**：替换卡片中的附件不破坏布局
- **附件预览**：快速预览各类附件内容

---

## 5. 用户界面优化

> 🎨 基于现有组件的 UI/UX 改进

### 5.1 主题与外观
- **深色主题**：完整的深色模式支持
- **主题色自定义**：选择喜欢的主题色
- **字体选择**：可选不同字体风格
- **紧凑模式**：减小间距，一屏显示更多内容

### 5.2 快捷键增强
- **自定义快捷键**：用户可自定义所有快捷键
- **快捷键面板**：按 `?` 显示所有可用快捷键
- **Vim 模式**：为高级用户提供 Vim 风格导航
- **命令面板**：类似 VS Code 的 `Cmd+P` 命令面板

### 5.3 工具栏自定义
- **工具栏位置**：可选顶部/底部/侧边工具栏
- **按钮排序**：自定义工具栏按钮顺序
- **常用功能固定**：将常用功能固定到工具栏
- **工具栏折叠**：在需要更大空间时折叠工具栏

### 5.4 卡片样式
- **卡片边框样式**：实线/虚线/无边框
- **卡片圆角**：可调节圆角大小
- **卡片阴影**：可调节阴影强度
- **卡片透明度**：可设置半透明卡片

### 5.5 辅助功能
- **屏幕阅读器优化**：完善 ARIA 标签
- **键盘完全可用**：所有功能可通过键盘完成
- **高对比度模式**：提供高对比度主题选项
- **减少动画**：为敏感用户提供减少动画选项

### 5.6 新手引导
- **交互式教程**：首次使用的交互式引导
- **功能提示**：新功能发布时的提示
- **帮助中心**：内置详细的帮助文档
- **视频教程**：嵌入的视频教程

### 5.7 右击菜单增强
- **自定义菜单项**：按使用频率排序菜单项
- **子菜单整理**：将相关功能整理到子菜单
- **最近使用**：显示最近使用的操作
- **搜索菜单**：在右击菜单中搜索功能

### 5.8 加载与性能感知
- **骨架屏**：内容加载时显示骨架屏
- **进度反馈**：长时间操作显示进度条
- **离线指示**：明确的离线状态指示
- **性能监控**：开发者可见的性能指标

### 5.9 反馈与帮助
- **内置反馈**：直接在应用内提交问题反馈
- **截图标注**：反馈时可标注截图
- **问题诊断**：自动收集调试信息（用户同意后）
- **社区对话**：链接到 Discord/论坛社区

### 5.10 多语言增强
- **语言自动检测**：根据浏览器设置自动选择语言
- **语言贡献**：用户可贡献翻译
- **术语统一**：确保同一功能名称全局一致
- **RTL 支持**：支持阿拉伯语、希伯来语等 RTL 语言

---

## 6. 移动端体验优化

> 📱 针对 iPad、手机等触控设备的优化

### 6.1 触控手势
- **双指拖拽画布**：更自然的画布导航
- **捏合缩放优化**：更流畅的缩放体验
- **长按上下文菜单**：替代右击菜单
- **滑动删除**：卡片列表滑动删除

### 6.2 移动端布局
- **响应式工具栏**：小屏幕自动调整布局
- **底部操作栏**：将主要操作移到拇指易达区
- **全屏卡片编辑**：编辑卡片时进入全屏模式
- **横竖屏适配**：自动适配屏幕方向

### 6.3 输入优化
- **智能键盘**：根据输入场景切换键盘类型
- **语音输入**：移动端强调语音输入功能
- **手写输入**：支持手写输入（需设备支持）
- **预测输入**：集成设备的预测输入功能

### 6.4 性能优化
- **渐进式加载**：优先加载可视区域的卡片
- **图片延迟加载**：滚动到可视区域才加载图片
- **离线缓存**：PWA 离线可用
- **电量优化**：降低后台刷新频率

### 6.5 通知与提醒
- **推送通知**：重要事件的推送通知
- **静默通知**：低优先级的静默同步
- **通知设置**：精细的通知偏好设置
- **勿扰模式**：集中工作时暂停通知

### 6.6 快速操作
- **快捷方式**：主屏幕快捷进入特定画板
- **分享扩展**：从其他应用分享内容到 NexMap
- **小组件**：显示最近画板的桌面小组件
- **快速笔记**：通知栏快速添加笔记

### 6.7 Apple Pencil 支持
- **手写识别**：Apple Pencil 手写转文字
- **涂鸦模式**：在画布上自由绘画
- **笔记批注**：在卡片上手写批注
- **双击切换**：双击 Pencil 切换工具

### 6.8 跨设备体验
- **无缝切换**：设备间无缝切换编辑
- **最近活动同步**：同步浏览历史和编辑位置
- **Handoff 支持**：iOS/macOS Handoff 接力
- **Universal Clipboard**：跨设备剪贴板

### 6.9 Widget 支持
- **最近画板 Widget**：显示最近使用的画板
- **快速创建 Widget**：一键创建新画板/新卡片
- **统计 Widget**：显示本周创作统计
- **收藏 Widget**：显示收藏的卡片

### 6.10 分屏多任务
- **分屏支持**：iPad 分屏多任务
- **拖拽导入**：从其他应用拖拽内容到 NexMap
- **画中画**：AI 生成时可继续其他操作
- **Slide Over**：支持 Slide Over 快速查看

---

## 实施优先级建议

### 第一阶段（1-2个月）- 核心体验
| 功能 | 优先级 | 预估工时 |
|-----|-------|---------|
| 智能卡片对齐系统 | ⭐⭐⭐ | 2周 |
| Prompt 模板系统 | ⭐⭐⭐ | 1周 |
| 深色主题 | ⭐⭐⭐ | 1周 |
| 公开链接分享 | ⭐⭐⭐ | 2周 |
| 高清图片导出 | ⭐⭐ | 1周 |

### 第二阶段（3-4个月）- 功能丰富
| 功能 | 优先级 | 预估工时 |
|-----|-------|---------|
| 智能布局算法 | ⭐⭐⭐ | 3周 |
| 对话上下文管理 | ⭐⭐⭐ | 2周 |
| 版本管理/快照 | ⭐⭐ | 2周 |
| 文件夹管理 | ⭐⭐ | 2周 |
| 移动端触控优化 | ⭐⭐ | 3周 |

### 第三阶段（5-6个月）- 协作与生态
| 功能 | 优先级 | 预估工时 |
|-----|-------|---------|
| 评论功能 | ⭐⭐ | 2周 |
| 模板系统 | ⭐⭐ | 2周 |
| Notion/Obsidian 集成 | ⭐ | 4周 |
| API 开放 | ⭐ | 4周 |

---

> 💡 **提示**：以上功能按照对现有代码改动量和用户价值综合评估。建议每次迭代选择 2-3 个功能重点实现，保持发布节奏。
